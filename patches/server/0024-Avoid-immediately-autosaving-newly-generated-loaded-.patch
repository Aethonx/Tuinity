From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Spottedleaf <Spottedleaf@users.noreply.github.com>
Date: Mon, 25 Nov 2019 05:45:45 -0800
Subject: [PATCH] Avoid immediately autosaving newly generated/loaded chunks

We shouldn't be saving them so soon after loading/generating, and
this specifically optimises elytra flying

diff --git a/src/main/java/net/minecraft/server/PlayerChunkMap.java b/src/main/java/net/minecraft/server/PlayerChunkMap.java
index 3caf30a7bbf58045fe35ce6d6ec4151b7dc70eaf..07a3ba722b120af3cee756b915a763a103daf42d 100644
--- a/src/main/java/net/minecraft/server/PlayerChunkMap.java
+++ b/src/main/java/net/minecraft/server/PlayerChunkMap.java
@@ -978,6 +978,8 @@ public class PlayerChunkMap extends IChunkLoader implements PlayerChunk.d {
                     playerchunk.a(new ProtoChunkExtension(chunk));
                 }
 
+                chunk.setLastSaved(this.world.getTime()); /* Concrete - avoid autosaving newly generated/loaded chunks */
+
                 chunk.a(() -> {
                     return PlayerChunk.getChunkState(playerchunk.getTicketLevel());
                 });
-- 
2.24.0.windows.2

